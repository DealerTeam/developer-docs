# 
version: 2.0
jobs:
  generate-docs-job:
    docker:
      - image: cimg/node:15.0.1
    steps:
      - checkout:   # Required step.  Checks out the code from your repository.
      - add_ssh_keys:
          fingerprints:
            - "48:8b:f1:8e:58:da:4a:a4:1f:cb:9e:7b:d4:9b:8a:10"
      - run:
          name:  display some info
          command: |
            node -v
            pwd
            ls -al
      - run:
          name: install Node package @cparra/apexdocs
          command: |
            npm update
            sudo npm install -g @cparra/apexdocs --no-package-lock
      - run:
          name: run apexdocs node package/command to generate docs
          command: |
            pwd
            mkdir outputdocs
            mkdir classcopy
            cp classes/* classcopy
            ls -la
            readlink -f outputdocs
            readlink -f classcopy
            sudo apexdocs-generate -s /home/circleci/project/classcopy -tÂ outputdocs -g jekyll
      - run:
          name: git commit the docs
          command: |
            mkdir source2
            cd source2
            git config user.email "matthewbayon@yahoo.com"
            git config user.name "gitmemattb"
            git clone https://github.com/DealerTeam/developer-docs.git
            cd developer-docs
            git checkout main
            cd ..
            cd ..
            cp -r outputdocs source2/developer-docs/docs
            cd source2/developer-docs
            git config --global user.email "matthewbayon@yahoo.com"
            git config --global user.name "gitmemattb"
            git commit --allow-empty -am "Automatic commit from CircleCI [skip ci]"
            git push origin main

workflows:
  version: 2
  build_and_test:
    jobs:
      - generate-docs-job:
          context: org-global        
#END-OF-CONFIG-FILE#
#DEALERTEAM.COM RELEASE ENGINEERING#
##